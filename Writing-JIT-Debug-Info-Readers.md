---
tip: translate by openai@2023-06-24 04:56:47
...
---
description: Writing JIT Debug Info Readers (Debugging with GDB)
distribution: global
Generator: makeinfo
keywords: Writing JIT Debug Info Readers (Debugging with GDB)
lang: en
resource-type: document
title: Writing JIT Debug Info Readers (Debugging with GDB)
---
::: header
Previous: [Using JIT Debug Info Readers](Using-JIT-Debug-Info-Readers.html#Using-JIT-Debug-Info-Readers)]
:::

---

#### 30.4.2 Writing JIT Debug Info Readers


As mentioned, a reader is essentially a shared object conforming to a certain ABI. This ABI is described in `jit-reader.h`.

> 如前所述，读取器本质上是符合某种ABI的共享对象。此ABI描述在“jit-reader.h”中。

`jit-reader.h` is the system include directory.


Readers need to be released under a GPL compatible license. A reader can be declared as released under such a license by placing the macro `GDB_DECLARE_GPL_COMPATIBLE_READER` in a source file.

> 读取器需要根据GPL兼容许可发布。可以通过在源文件中放置宏`GDB_DECLARE_GPL_COMPATIBLE_READER`来声明读取器已经发布了GPL兼容许可。


The entry point for readers is the symbol `gdb_init_reader`, which is expected to be a function with the prototype

> 读者的入口点是符号`gdb_init_reader`，预期它是一个具有原型的函数

::: smallexample

```bash
extern struct gdb_reader_funcs *gdb_init_reader (void);
```

:::

`struct gdb_reader_funcs` contains a set of pointers to callback functions. These functions are executed to read the debug info generated by the JIT compiler (`read`), to unwind stack frames (`unwind`) and to create canonical frame IDs (`get_frame_id`). It also has a callback that is called when the reader is being unloaded (`destroy`). The struct looks like this

::: smallexample

```bash
struct gdb_reader_funcs
{
  /* Must be set to GDB_READER_INTERFACE_VERSION.  */
  int reader_version;

  /* For use by the reader.  */
  void *priv_data;

  gdb_read_debug_info *read;
  gdb_unwind_frame *unwind;
  gdb_get_frame_id *get_frame_id;
  gdb_destroy_reader *destroy;
};
```

:::


The callbacks are provided with another set of callbacks by [GDB] to do their job. For `read`, these callbacks are passed in a `struct gdb_symbol_callbacks` and for `unwind` and `get_frame_id`, in a `struct gdb_unwind_callbacks`. `struct gdb_symbol_callbacks` has callbacks to create new object files and new symbol tables inside those object files. `struct gdb_unwind_callbacks` has callbacks to read registers off the current frame and to write out the values of the registers in the previous frame. Both have a callback (`target_read`) to read bytes off the target's address space.

> 回调函数由GDB提供另一组回调函数来完成其工作。对于“读取”，这些回调函数被传入一个“struct gdb_symbol_callbacks”，对于“unwind”和“get_frame_id”，则传入一个“struct gdb_unwind_callbacks”。“struct gdb_symbol_callbacks”有回调函数来创建新的对象文件，以及这些对象文件中的新符号表。“struct gdb_unwind_callbacks”有回调函数读取当前帧的寄存器，以及将上一帧的寄存器值写出。两者都有一个回调函数（“target_read”）来读取目标地址空间的字节。

---

::: header
Previous: [Using JIT Debug Info Readers](Using-JIT-Debug-Info-Readers.html#Using-JIT-Debug-Info-Readers)]
:::
